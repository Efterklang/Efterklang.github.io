<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>DataBase Base_函数&amp;约束 - Efterklang</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="Efterklang"><meta name="msapplication-TileImage" content="/img/favicon.svg"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Efterklang"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="数据库学习笔记，本篇主要记录SQL函数以及约束相关的知识点。"><meta property="og:type" content="article"><meta property="og:title" content="DataBase Base_函数&amp;约束"><meta property="og:url" content="https://efterklang.github.io/Tech/DataBase/DataBase02/"><meta property="og:site_name" content="Efterklang"><meta property="og:description" content="数据库学习笔记，本篇主要记录SQL函数以及约束相关的知识点。"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://efterklang.github.io/img/thumbnails/Database_Image.jpg"><meta property="article:published_time" content="2024-01-27T14:23:27.000Z"><meta property="article:modified_time" content="2024-02-13T07:36:09.197Z"><meta property="article:author" content="Efterklang"><meta property="article:tag" content="DataBase"><meta property="article:tag" content="SQL"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="https://efterklang.github.io/img/thumbnails/Database_Image.jpg"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://efterklang.github.io/Tech/DataBase/DataBase02/"},"headline":"DataBase Base_函数&约束","image":["https://efterklang.github.io/img/thumbnails/Database_Image.jpg"],"datePublished":"2024-01-27T14:23:27.000Z","dateModified":"2024-02-13T07:36:09.197Z","author":{"@type":"Person","name":"Efterklang"},"publisher":{"@type":"Organization","name":"Efterklang","logo":{"@type":"ImageObject","url":{"light":"/img/sunflower.png","dark":"/img/sunflower.png"}}},"description":"数据库学习笔记，本篇主要记录SQL函数以及约束相关的知识点。"}</script><link rel="canonical" href="https://efterklang.github.io/Tech/DataBase/DataBase02/"><link rel="icon" href="/img/favicon.svg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.2/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.9.0/styles/tokyo-night-dark.css"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><meta name="msvalidate.01" content="039770FFD6F5D1B53B42B9D3271EA9B9"><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" defer></script><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"><!--!--><!--!--><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><!--!--><!--!--><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const id = '#' + CSS.escape(location.hash.substring(1));
          const $tabMenu = document.querySelector(`.tabs a[href="${id}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(id);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="Efterklang" type="application/atom+xml">
</head><body class="is-2-column"><script type="text/javascript" src="/js/imaegoo/night.js"></script><canvas id="universe"></canvas><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img class="logo-img" src="/img/sunflower.png" alt="Efterklang" height="28"><img class="logo-img-dark" src="/img/sunflower.png" alt="Efterklang" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/gallery">Gallery</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item is-hidden-tablet catalogue" title="Catalogue" href="javascript:;"><i class="fas fa-list-ul"></i><span>  目录</span></a><a class="navbar-item night" id="night-nav" title="Night Mode" href="javascript:;"><i class="fas fa-moon" id="night-icon"></i></a><a class="navbar-item" target="_blank" rel="noopener" title="github" href="https://github.com/Efterklang"><i class="fab fa-github"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><div class="card-image"><span class="image is-7by3"><img class="fill" src="/img/thumbnails/Database_Image.jpg" alt="DataBase Base_函数&amp;约束" referrerpolicy="no-referrer"></span></div><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2024-01-27T14:23:27.000Z" title="1/27/2024, 10:23:27 PM">2024-01-27</time></span><span class="level-item"><a class="link-muted" href="/categories/Tech/">Tech</a><span> / </span><a class="link-muted" href="/categories/Tech/DataBase/">DataBase</a></span><span class="level-item">10 minutes read (About 1495 words)</span><span class="level-item leancloud_visitors" id="/Tech/DataBase/DataBase02/" data-flag-title="DataBase Base_函数&amp;约束"><i class="far fa-eye"></i>&nbsp;&nbsp;<span id="twikoo_visitors"><i class="fa fa-spinner fa-spin"></i></span>&nbsp;visits</span></div></div><h1 class="title is-3 is-size-4-mobile">DataBase Base_函数&amp;约束</h1><div class="content"><h1 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h1><h2 id="AggregateFunction"><a href="#AggregateFunction" class="headerlink" title="AggregateFunction"></a>AggregateFunction</h2><h3 id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a>Overview</h3><blockquote>
<p>An SQL aggregate function calculates on a set of values and returns a single value<br>Because an aggregate function operates on a set of values, it is often used with the GROUP BY clause of the SELECT statement. The GROUP BY clause divides the result set into groups of values and the aggregate function returns a single value for each group.<br><a target="_blank" rel="noopener" href="https://www.sqltutorial.org/sql-aggregate-functions/"><em>SQL Tutorial</em></a></p>
</blockquote>
<p>The following are the commonly used SQL aggregate functions:</p>
<ul>
<li><code>AVG()</code> – returns the average of a set</li>
<li><code>COUNT()</code> – returns the number of items in a set</li>
<li><code>COUNT(*)</code> – returns the number of items in a set (including NULL values)</li>
<li><code>MAX()</code> – returns the maximum value in a set</li>
<li><code>MIN()</code> – returns the minimum value in a set</li>
<li><code>SUM()</code> – returns the sum of all or distinct values in a set</li>
</ul>
<p>Except for the <code>COUNT()</code> function, SQL aggregate functions ignore null.</p>
<p>You can use aggregate functions as expressions only in the following:</p>
<ul>
<li>The select list of a SELECT statement, either a subquery or an outer query.</li>
<li>A HAVING clause</li>
</ul>
<h2 id="StringFunction"><a href="#StringFunction" class="headerlink" title="StringFunction"></a>StringFunction</h2><p>Functions that allow you to manipulate string data more effectively.</p>
<ul>
<li><code>CONCAT(s1,s2,...,sn)</code> – return the result of concatenation two strings together.</li>
<li><code>LOWER(str),UPPER(str)</code> – converts a string to lower case or upper case.</li>
<li><code>LPAD(str,n,padstr),RPAD(str,n,padstr)</code> – left&#x2F;right pads a string with another string to a certain length.</li>
<li><code>TRIM(str),LTRIM(str),RTRIM(str)</code> – removes all spaces from a string or from the left or right side of a string.</li>
<li><code>REPLACE(str,source,replace)</code> – replaces all occurrences of a substring within a string with another substring.</li>
<li><code>SUBSTRING(str,pos,len)</code> – returns a substring from a string starting at a specified position with a specified length.<br>Reference:</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> CONCAT(<span class="string">&#x27;SQL&#x27;</span>,<span class="string">&#x27; is&#x27;</span>,<span class="string">&#x27; fun!&#x27;</span>);</span><br><span class="line"><span class="operator">+</span><span class="comment">-------------------------+</span></span><br><span class="line"><span class="operator">|</span> CONCAT(&quot;HELLO&quot;,&quot;WORLD&quot;) <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------------------------+</span></span><br><span class="line"><span class="operator">|</span> HELLOWORLD              <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------------------------+</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">LOWER</span>(&quot;Hello,World&quot;);</span><br><span class="line"><span class="operator">+</span><span class="comment">----------------------+</span></span><br><span class="line"><span class="operator">|</span> <span class="built_in">LOWER</span>(&quot;Hello,World&quot;) <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------------------+</span></span><br><span class="line"><span class="operator">|</span> hello,world          <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------------------+</span></span><br><span class="line"><span class="keyword">SELECT</span> RPAD(&quot;1&quot;,<span class="number">5</span>,&quot;Z&quot;);</span><br><span class="line"><span class="operator">+</span><span class="comment">-----------------+</span></span><br><span class="line"><span class="operator">|</span> RPAD(&quot;1&quot;,<span class="number">5</span>,&quot;Z&quot;) <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-----------------+</span></span><br><span class="line"><span class="operator">|</span> <span class="number">1</span>ZZZZ           <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-----------------+</span></span><br><span class="line"><span class="keyword">SELECT</span> RTRIM(&quot;  HELLO   &quot;);</span><br><span class="line"><span class="operator">+</span><span class="comment">---------------------+</span></span><br><span class="line"><span class="operator">|</span> RTRIM(&quot;  HELLO   &quot;) <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------------------+</span></span><br><span class="line"><span class="operator">|</span>   HELLO             <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------------------+</span></span><br><span class="line"><span class="keyword">SELECT</span> REPLACE(&quot;Hello,World&quot;,&quot;World&quot;,&quot;SQL&quot;);</span><br><span class="line"><span class="operator">+</span><span class="comment">--------------------------------------+</span></span><br><span class="line"><span class="operator">|</span> REPLACE(&quot;Hello,World&quot;,&quot;World&quot;,&quot;SQL&quot;) <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------------------------------+</span></span><br><span class="line"><span class="operator">|</span> Hello,<span class="keyword">SQL</span>                            <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------------------------------+</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">SUBSTRING</span>(&quot;Hello,World&quot;,<span class="number">1</span>,<span class="number">5</span>);</span><br><span class="line"><span class="operator">+</span><span class="comment">------------------------------+</span></span><br><span class="line"><span class="operator">|</span> <span class="built_in">SUBSTRING</span>(&quot;Hello,World&quot;,<span class="number">1</span>,<span class="number">5</span>) <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------------------------------+</span></span><br><span class="line"><span class="operator">|</span> Hello                        <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------------------------------+</span></span><br></pre></td></tr></table></figure>

<h2 id="Math-Functions"><a href="#Math-Functions" class="headerlink" title="Math Functions"></a>Math Functions</h2><p>SQL has many mathematical functions that allow you to perform business and engineering calculations.</p>
<ul>
<li><code>ABS(x)</code> – returns the absolute value of x.</li>
<li><code>CEIL(x)</code> – returns the smallest integer that is greater than or equal to x.</li>
<li><code>FLOOR(x)</code> – returns the largest integer that is less than or equal to x.</li>
<li><code>RAND()</code> – returns a random floating-point value.</li>
<li><code>MOD(x,y)</code> – returns the remainder(modulo) of x divided by y, <code>MOD(10,7)</code> returns 3. e.g.</li>
<li><code>ROUND(x,d)</code> – returns a number rounded to d decimal places. <code>ROUND(2.6666,3)</code> returns 2.667 e.g.</li>
</ul>
<p><strong>Exercise</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- randomly generate 6 digits</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">SUBSTRING</span>(ROUND(RAND(),<span class="number">6</span>),<span class="number">3</span>,<span class="number">6</span>);</span><br><span class="line"><span class="operator">+</span><span class="comment">--------------------------------+</span></span><br><span class="line"><span class="operator">|</span> <span class="built_in">SUBSTRING</span>(ROUND(RAND(),<span class="number">6</span>),<span class="number">3</span>,<span class="number">6</span>) <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------------------------+</span></span><br><span class="line"><span class="operator">|</span> <span class="number">578207</span>                         <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------------------------+</span></span><br></pre></td></tr></table></figure>

<h2 id="Date-Functions"><a href="#Date-Functions" class="headerlink" title="Date Functions"></a>Date Functions</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> CURDATE(); <span class="comment">-- YYYY-MM-DD</span></span><br><span class="line"><span class="keyword">SELECT</span> CURTIME(); <span class="comment">-- HH:MM:SS</span></span><br><span class="line"><span class="keyword">SELECT</span> NOW(); <span class="comment">-- YYYY-MM-DD HH:MM:SS</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">YEAR</span>(<span class="type">date</span>); <span class="keyword">MONTH</span>(<span class="type">date</span>); <span class="keyword">DAY</span>(<span class="type">date</span>);</span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">YEAR</span>(&quot;2023-1-2&quot;);</span><br><span class="line"><span class="operator">+</span><span class="comment">------------------+</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">YEAR</span>(&quot;2023-1-2&quot;) <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------------------+</span></span><br><span class="line"><span class="operator">|</span>             <span class="number">2023</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------------------+</span></span><br><span class="line"></span><br><span class="line">DATEADD(<span class="type">date</span>,<span class="type">INTERVAL</span> expr type);</span><br><span class="line">DATEDIFF(date1,date2); <span class="comment">-- date1 - date2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> DATE_ADD(now(),<span class="type">INTERVAL</span> <span class="number">70</span> <span class="keyword">DAY</span>);</span><br><span class="line"><span class="operator">+</span><span class="comment">---------------------------------+</span></span><br><span class="line"><span class="operator">|</span> DATE_ADD(now(),<span class="type">INTERVAL</span> <span class="number">70</span> <span class="keyword">DAY</span>) <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------------------------------+</span></span><br><span class="line"><span class="operator">|</span> <span class="number">2024</span><span class="number">-04</span><span class="number">-06</span> <span class="number">20</span>:<span class="number">09</span>:<span class="number">20</span>             <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------------------------------+</span></span><br><span class="line"><span class="keyword">SELECT</span> DATEDIFF(now(),&quot;2023-1-20&quot;);</span><br><span class="line"><span class="operator">+</span><span class="comment">-----------------------------+</span></span><br><span class="line"><span class="operator">|</span> DATEDIFF(now(),&quot;2023-1-20&quot;) <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-----------------------------+</span></span><br><span class="line"><span class="operator">|</span>                         <span class="number">372</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-----------------------------+</span></span><br></pre></td></tr></table></figure>

<p><strong>Exercises</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查询每个员工的入职天数，并按照入职天数降序排列</span></span><br><span class="line"><span class="keyword">SELECT</span> Name,DATEDIFF(now(),entrydate) <span class="keyword">AS</span> days <span class="keyword">FROM</span> emp <span class="keyword">ORDER</span> <span class="keyword">BY</span> days <span class="keyword">DESC</span>;</span><br></pre></td></tr></table></figure>

<h2 id="Control-Flow-Functions"><a href="#Control-Flow-Functions" class="headerlink" title="Control Flow Functions"></a>Control Flow Functions</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--  if value is true, return if_true_expr, else return if_false_expr</span></span><br><span class="line">IF(<span class="keyword">value</span>,if_true_expr,if_false_expr)</span><br><span class="line"><span class="comment">-- if expr1 IS NULL, return expr2, else return expr1</span></span><br><span class="line">IFNULL(expr1,expr2)</span><br><span class="line"><span class="comment">-- condition1为真，返回result1，condition2为真，返回result2，否则返回result</span></span><br><span class="line"><span class="keyword">CASE</span> <span class="keyword">WHEN</span> <span class="operator">&lt;</span>condition1<span class="operator">&gt;</span> <span class="keyword">THEN</span> <span class="operator">&lt;</span>result1<span class="operator">&gt;</span> <span class="keyword">WHEN</span> <span class="operator">&lt;</span>condition2<span class="operator">&gt;</span> <span class="keyword">THEN</span> <span class="operator">&lt;</span>result2<span class="operator">&gt;</span> <span class="keyword">ELSE</span> <span class="operator">&lt;</span><span class="keyword">result</span><span class="operator">&gt;</span> <span class="keyword">END</span></span><br><span class="line"><span class="comment">-- expr = value1, return result1, expr = value2, return result2, else return result</span></span><br><span class="line"><span class="keyword">CASE</span> <span class="operator">&lt;</span>expr<span class="operator">&gt;</span> <span class="keyword">WHEN</span> value1 <span class="keyword">THEN</span> result1 <span class="keyword">WHEN</span> value2 <span class="keyword">THEN</span> result2 <span class="keyword">ELSE</span> <span class="keyword">result</span> <span class="keyword">END</span></span><br></pre></td></tr></table></figure>

<p><strong>Exercises</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查询emp表的员工的name,addr,如果addr为Beijing/Shanghai,则显示为一线城市，否则显示为二线城市</span></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line"> name,</span><br><span class="line"> (<span class="keyword">CASE</span> addr <span class="keyword">WHEN</span> <span class="string">&#x27;Beijing&#x27;</span> <span class="keyword">THEN</span> <span class="string">&#x27;一线城市&#x27;</span>  <span class="keyword">WHEN</span> &quot;Shanghai&quot; <span class="keyword">THEN</span> &quot;一线城市&quot; <span class="keyword">ELSE</span> <span class="string">&#x27;二线城市&#x27;</span> <span class="keyword">END</span>) <span class="keyword">AS</span> addrTag</span><br><span class="line"><span class="keyword">FROM</span> emp;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查询学生成绩表，如果成绩大于等于60，显示及格，否则显示不及格</span></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line"> name.</span><br><span class="line"> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> score <span class="operator">&gt;=</span> <span class="number">60</span> <span class="keyword">THEN</span> <span class="string">&#x27;及格&#x27;</span> <span class="keyword">ELSE</span> <span class="string">&#x27;不及格&#x27;</span> <span class="keyword">END</span> <span class="keyword">AS</span>) math,</span><br><span class="line"> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> english <span class="operator">&gt;=</span> <span class="number">60</span> <span class="keyword">THEN</span> <span class="string">&#x27;及格&#x27;</span> <span class="keyword">ELSE</span> <span class="string">&#x27;不及格&#x27;</span> <span class="keyword">END</span> <span class="keyword">AS</span>) english,</span><br><span class="line"><span class="keyword">FROM</span> score;</span><br></pre></td></tr></table></figure>

<h1 id="约束"><a href="#约束" class="headerlink" title="约束"></a>约束</h1><h2 id="Overview-1"><a href="#Overview-1" class="headerlink" title="Overview"></a>Overview</h2><p><strong>概念</strong>: 约束是作用于表中字段上的规则,用于限制存储在表中的数据(类型、格式和范围等等)<br><strong>目的</strong>: 保证数据的正确性、有效性和完整性<br><strong>分类</strong>:</p>
<table>
<thead>
<tr>
<th align="left">约束</th>
<th align="left">描述</th>
<th align="left">关键字</th>
</tr>
</thead>
<tbody><tr>
<td align="left">非空约束</td>
<td align="left">限制该字段的数据不能为 null</td>
<td align="left">NOT NULL</td>
</tr>
<tr>
<td align="left">唯一约束</td>
<td align="left">保证该字段的所有数据都是唯一、不重复的</td>
<td align="left">UNIQUE</td>
</tr>
<tr>
<td align="left">主键约束</td>
<td align="left">主键是一行数据的唯一标识，要求非空且唯一</td>
<td align="left">PRIMARY KEY</td>
</tr>
<tr>
<td align="left">默认约束</td>
<td align="left">保存数据时，如果未指定该字段的值，则采用默认值</td>
<td align="left">DEFAULT</td>
</tr>
<tr>
<td align="left">检查约束（8.0.1 版本后）</td>
<td align="left">保证字段值满足某一个条件</td>
<td align="left">CHECK</td>
</tr>
<tr>
<td align="left">外键约束</td>
<td align="left">用来让两张图的数据之间建立连接，保证数据的一致性和完整性</td>
<td align="left">FOREIGN KEY</td>
</tr>
</tbody></table>
<p><strong>Example</strong></p>
<p>[[DataBase01#DML]] <a href="https://efterklang.github.io/Tech/DataBase/DataBase01/#DML">Review DML Syntax</a></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="keyword">USER</span>(</span><br><span class="line">  id <span class="type">INT</span> <span class="keyword">PRIMARY</span> KEY AUTO_INCREMENT,</span><br><span class="line">  name <span class="type">VARCHAR</span>(<span class="number">10</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">UNIQUE</span>,</span><br><span class="line">  age TINYINT UNSIGNED <span class="keyword">CHECK</span>(age<span class="operator">&gt;</span><span class="number">0</span> <span class="keyword">AND</span> age<span class="operator">&lt;</span><span class="number">120</span>),</span><br><span class="line">  gender ENUM(<span class="string">&#x27;男&#x27;</span>,<span class="string">&#x27;女&#x27;</span>,<span class="string">&#x27;保密&#x27;</span>) <span class="keyword">DEFAULT</span> <span class="string">&#x27;保密&#x27;</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<h2 id="外键约束"><a href="#外键约束" class="headerlink" title="外键约束"></a>外键约束</h2><p><strong>概念</strong> : 外键是表中的一个字段，它指向另一个表的主键，用来建立两张表之间的联系，保证数据的<strong>一致性和完整性</strong></p>
<p><strong>语法</strong> : <code>FOREIGN KEY (&lt;foreignKey&gt;) REFERENCES &lt;tableName&gt;(&lt;primaryKey&gt;)</code></p>
<p><strong>Example</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建了两张表，Company表(主表,父表)中的Id字段是主键，Department表(子表,从表)中的depa_id字段是外键，指向Company表中的Id字</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> Company (</span><br><span class="line">    Id <span class="type">int</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    name <span class="type">varchar</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    <span class="keyword">PRIMARY</span> KEY (Id)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> Department (</span><br><span class="line">    id <span class="type">int</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    name <span class="type">varchar</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    salary <span class="type">decimal</span>(<span class="number">10</span>,<span class="number">2</span>),</span><br><span class="line">    depa_id <span class="type">int</span>,</span><br><span class="line">    <span class="keyword">PRIMARY</span> KEY (id),</span><br><span class="line">    <span class="keyword">FOREIGN</span> KEY (depa_id) <span class="keyword">REFERENCES</span> Company(Id)</span><br><span class="line">);</span><br><span class="line"><span class="comment">-- 添加外键约束</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> Department <span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> fk_depa_id <span class="keyword">FOREIGN</span> KEY (depa_id) <span class="keyword">REFERENCES</span> Company(Id);</span><br><span class="line"><span class="comment">-- 删除外键约束</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> Department <span class="keyword">DROP</span> <span class="keyword">FOREIGN</span> KEY fk_depa_id;</span><br></pre></td></tr></table></figure>

<h2 id="删除-更新行为"><a href="#删除-更新行为" class="headerlink" title="删除&#x2F;更新行为"></a>删除&#x2F;更新行为</h2><table>
<thead>
<tr>
<th align="left">行为</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left">NO ACTION</td>
<td align="left">当在父表中删除&#x2F;更新对应记录时，首先检查该记录是否有对应外键，如果有则不允许删除&#x2F;更新（与RESTRICT一致）</td>
</tr>
<tr>
<td align="left">RESTRICT</td>
<td align="left">当在父表中删除&#x2F;更新对应记录时，首先检查该记录是否有对应外键，如果有则不允许删除&#x2F;更新（与NO ACTION一致）</td>
</tr>
<tr>
<td align="left">CASCADE</td>
<td align="left">当在父表中删除&#x2F;更新对应记录时，首先检查该记录是否有对应外键，如果有则也删除&#x2F;更新外键在子表中的记录</td>
</tr>
<tr>
<td align="left">SET NULL</td>
<td align="left">当在父表中删除&#x2F;更新对应记录时，首先检查该记录是否有对应外键，如果有则设置子表中该外键值为null（要求该外键允许为null）</td>
</tr>
<tr>
<td align="left">SET DEFAULT</td>
<td align="left">父表有变更时，子表将外键设为一个默认值（Innodb不支持）</td>
</tr>
</tbody></table>
<p>设置删除&#x2F;更新行为的语法：<code>ON DELETE/UPDATE &lt;action&gt;</code><br>例如 <code>ALTER TABLE Department ADD CONSTRAINT fk_depa_id FOREIGN KEY (depa_id) REFERENCES Company(Id) ON DELETE CASCADE ON UPDATE CASCADE;</code></p>
</div><div class="article-licensing box"><div class="licensing-title"><p>DataBase Base_函数&amp;约束</p><p><a href="https://efterklang.github.io/Tech/DataBase/DataBase02/">https://efterklang.github.io/Tech/DataBase/DataBase02/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>Author</h6><p>Efterklang</p></div></div><div class="level-item is-narrow"><div><h6>Posted on</h6><p>2024-01-27</p></div></div><div class="level-item is-narrow"><div><h6>Updated on</h6><p>2024-02-13</p></div></div><div class="level-item is-narrow"><div><h6>Licensed under</h6><p><a class="icons" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="icon fab fa-creative-commons"></i></a><a class="icons" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="icon fab fa-creative-commons-by"></i></a><a class="icons" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="icon fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/DataBase/">DataBase</a><a class="link-muted mr-2" rel="tag" href="/tags/SQL/">SQL</a></div><!--!--></article></div><!--!--><div class="card"><nav class="post-navigation mt-4 level is-mobile card-content"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/Game/CyberPunk2077/2077%E4%BB%BB%E5%8A%A1%E5%90%8D%E4%B8%AD%E7%9A%84%E5%BD%A9%E8%9B%8B/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">2077任务名中的彩蛋</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/Tech/DataBase/Glossary%20Of%20SQL/"><span class="level-item">Glossary Of SQL</span><i class="level-item fas fa-chevron-right"></i></a></div></nav></div><div class="card"><div class="card-content"><h3 class="title is-5">Comments</h3><div class="content twikoo" id="twikoo"></div><script src="https://cdn.jsdelivr.net/npm/twikoo@1.6.30/dist/twikoo.all.min.js"></script><script>twikoo.init({
      envId: 'https://luminous-praline-90b359.netlify.app/.netlify/functions/twikoo',
      onCommentLoaded: function () {
        var commentContents = document.getElementsByClassName('tk-content');
        for (var i = 0; i < commentContents.length; i++) {
          var commentItem = commentContents[i];
          var imgEls = commentItem.getElementsByTagName('img');
          if (imgEls.length > 0) {
            for (var j = 0; j < imgEls.length; j++) {
              var imgEl = imgEls[j];
              var aEl = document.createElement('a');
              aEl.setAttribute('class', 'tk-lg-link');
              aEl.setAttribute('href', imgEl.getAttribute('src'));
              aEl.setAttribute('data-src', imgEl.getAttribute('src'));
              aEl.appendChild(imgEl.cloneNode(false));
              imgEl.parentNode.insertBefore(aEl, imgEl.nextSibling);
              imgEl.remove();
            }
            if (typeof $.fn.lightGallery === 'function') {
              $(commentItem).lightGallery({
                selector: '.tk-lg-link'
              });
            }
          }
        }
      }
    });</script></div></div></div><style>.column.column-left,.column.column-right{display:none}</style><!--!--><div class="column column-right is-4-tablet is-4-desktop is-4-widescreen  order-3 is-sticky"><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">Catalogue</h3><ul class="menu-list"><li><a class="level is-mobile" href="#函数"><span class="level-left"><span class="level-item">1</span><span class="level-item">函数</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#AggregateFunction"><span class="level-left"><span class="level-item">1.1</span><span class="level-item">AggregateFunction</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#Overview"><span class="level-left"><span class="level-item">1.1.1</span><span class="level-item">Overview</span></span></a></li></ul></li><li><a class="level is-mobile" href="#StringFunction"><span class="level-left"><span class="level-item">1.2</span><span class="level-item">StringFunction</span></span></a></li><li><a class="level is-mobile" href="#Math-Functions"><span class="level-left"><span class="level-item">1.3</span><span class="level-item">Math Functions</span></span></a></li><li><a class="level is-mobile" href="#Date-Functions"><span class="level-left"><span class="level-item">1.4</span><span class="level-item">Date Functions</span></span></a></li><li><a class="level is-mobile" href="#Control-Flow-Functions"><span class="level-left"><span class="level-item">1.5</span><span class="level-item">Control Flow Functions</span></span></a></li></ul></li><li><a class="level is-mobile" href="#约束"><span class="level-left"><span class="level-item">2</span><span class="level-item">约束</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#Overview-1"><span class="level-left"><span class="level-item">2.1</span><span class="level-item">Overview</span></span></a></li><li><a class="level is-mobile" href="#外键约束"><span class="level-left"><span class="level-item">2.2</span><span class="level-item">外键约束</span></span></a></li><li><a class="level is-mobile" href="#删除-更新行为"><span class="level-left"><span class="level-item">2.3</span><span class="level-item">删除/更新行为</span></span></a></li></ul></li></ul></div></div><script src="/js/toc.js" defer></script></div><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">Categories</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/Game/"><span class="level-start"><span class="level-item">Game</span></span><span class="level-end"><span class="level-item tag">3</span></span></a><ul><li><a class="level is-mobile" href="/categories/Game/CyberPunk2077/"><span class="level-start"><span class="level-item">CyberPunk2077</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/Game/The-Witcher-3/"><span class="level-start"><span class="level-item">The Witcher 3</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/Reading/"><span class="level-start"><span class="level-item">Reading</span></span><span class="level-end"><span class="level-item tag">3</span></span></a><ul><li><a class="level is-mobile" href="/categories/Reading/Poems/"><span class="level-start"><span class="level-item">Poems</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/Tech/"><span class="level-start"><span class="level-item">Tech</span></span><span class="level-end"><span class="level-item tag">20</span></span></a><ul><li><a class="level is-mobile" href="/categories/Tech/DataBase/"><span class="level-start"><span class="level-item">DataBase</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/categories/Tech/FrontEnd/"><span class="level-start"><span class="level-item">FrontEnd</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Tech/Java/"><span class="level-start"><span class="level-item">Java</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/categories/Tech/Network/"><span class="level-start"><span class="level-item">Network</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/categories/Tech/Others/"><span class="level-start"><span class="level-item">Others</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/Tech/VSCode/"><span class="level-start"><span class="level-item">VSCode</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li></ul></li></ul></div></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">Archives</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2024/02/"><span class="level-start"><span class="level-item">February 2024</span></span><span class="level-end"><span class="level-item tag">11</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/01/"><span class="level-start"><span class="level-item">January 2024</span></span><span class="level-end"><span class="level-item tag">16</span></span></a></li></ul></div></div></div></div><style>.column.column-left,.column.column-right{display:block}</style></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img class="logo-img" src="/img/sunflower.png" alt="Efterklang" height="28"><img class="logo-img-dark" src="/img/sunflower.png" alt="Efterklang" height="28"></a><p class="is-size-7"><span>&copy; 2024 Efterklang</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/imaegoo/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a><br><span id="busuanzi_container_site_uv">Visited by <span id="busuanzi_value_site_uv">0</span> users</span></p><p class="is-size-7">© 2019</p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="GitHub" href="https://github.com/Efterklang"><i class="fab fa-github"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/twikoo@1.6.30/dist/twikoo.all.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "This website uses cookies to improve your experience.",
          dismiss: "Got it!",
          allow: "Allow cookies",
          deny: "Decline",
          link: "Learn more",
          policy: "Cookie Policy",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css"><script src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/contrib/auto-render.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/contrib/mhchem.min.js" defer></script><script>window.addEventListener("load", function() {
            document.querySelectorAll('[role="article"] > .content').forEach(function(element) {
                renderMathInElement(element);
            });
        });</script><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><div class="searchbox-pinyin"><label class="checkbox"><input id="search-by-pinyin" type="checkbox" checked="checked"><span> 拼音检索</span></label></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/imaegoo/pinyin.js" defer></script><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script><script type="text/javascript" src="/js/imaegoo/imaegoo.js"></script><script type="text/javascript" src="/js/imaegoo/universe.js"></script></body></html>